{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/회고/BASENOTE-REF/",
    "result": {"data":{"site":{"siteMetadata":{"title":"🏃🏻UndefinedP.log","author":"UndefinedP","siteUrl":"https://undefinedp.github.io","comment":{"disqusShortName":"","utterances":"undefinedP/undefinedp.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"5389e3cc-284e-5be6-832f-f0c362969c28","excerpt":"이전에 했던 BASENOTE 프로젝트에서 구현하지 못했던 필터링 기능을 시간이 나는 김에 한번 구현을 해보자고 결심을 했다. (참고로 이건 BASENOTE 프로젝트 이후에 작성한 회고록><) ⚡️ GITHUB  ❗️이번에 코드를 작성하면서 고려한 것 이전에 작성한 코드를 갈아엎는 것을 최대한 줄이기. 중복되는 코드를 줄이기 → 결론적으로 말하자면..반 성공 반 실패인거같다. 분명히 더 나은 방법이 있을텐데…🤔 일단 앞선 회고에서 내가 의미있는 코드라고 냅다 적었던 KEY ERROR…","html":"<p>이전에 했던 BASENOTE 프로젝트에서 구현하지 못했던 필터링 기능을 시간이 나는 김에 한번 구현을 해보자고 결심을 했다.</p>\n<p><a href=\"https://undefinedp.github.io/%ED%9A%8C%EA%B3%A0/BASENOTE/\">(참고로 이건 BASENOTE 프로젝트 이후에 작성한 회고록>&#x3C;)</a></p>\n<p><a href=\"https://github.com/undefinedP/fullstack1-1st-BaseNote-backend\">⚡️ GITHUB </a></p>\n<br/>\n<h3 id=\"️이번에-코드를-작성하면서-고려한-것\" style=\"position:relative;\"><a href=\"#%EF%B8%8F%EC%9D%B4%EB%B2%88%EC%97%90-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%98%EB%A9%B4%EC%84%9C-%EA%B3%A0%EB%A0%A4%ED%95%9C-%EA%B2%83\" aria-label=\"️이번에 코드를 작성하면서 고려한 것 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>❗️이번에 코드를 작성하면서 고려한 것</h3>\n<ol>\n<li>\n<p>이전에 작성한 코드를 갈아엎는 것을 최대한 줄이기.</p>\n</li>\n<li>\n<p>중복되는 코드를 줄이기 → 결론적으로 말하자면..반 성공 반 실패인거같다. 분명히 더 나은 방법이 있을텐데…🤔</p>\n</li>\n</ol>\n<br/>\n<p>일단 앞선 회고에서 내가 의미있는 코드라고 냅다 적었던 <a href=\"https://undefinedp.github.io/%ED%9A%8C%EA%B3%A0/BASENOTE/#%EB%BF%8C%EB%93%AF%ED%96%88%EB%8D%98-%EC%BD%94%EB%93%9C\">KEY ERROR을 띄우는 코드는…</a>정말로 “KEY ERROR”을 띄우는게 아니라 그냥 인풋에 공백이 들어왔을 때를 판단해서 에러를 띄우는 코드였다. 그런데 <code class=\"language-text\">KEY_ERROR</code>라는건 클라이언트 측에서 정보가 넘어올 때 정보의 인풋이 아무것도 없을 때에 뿌려줬어야 하는 것..! 두둥… 그래서 코드를 다시 새롭게 바꾸어 보았다</p>\n<p><img src=\"https://cdn.clien.net/web/api/file/F01/11192364/81ed5714fbd8de.jpg\" alt=\"０ vs null\">\n얘랑 똑같았다. 내가 해야했던건 NULL에 대한 에러 핸들링이었지만 여태까지 0에 대한 에러 핸들링을 하고있었으니..그래 그렇게 됐다</p>\n<p>어쨌든 이게 바꾼 코드!</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">signUp</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> name<span class=\"token punctuation\">,</span> email<span class=\"token punctuation\">,</span> userAccount<span class=\"token punctuation\">,</span> phoneNumber<span class=\"token punctuation\">,</span> password <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body\n\n    <span class=\"token keyword\">const</span> requiredKeys <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">'name'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'email'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'userAccount'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'phoneNumber'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'password'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> key <span class=\"token keyword\">of</span> requiredKeys<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> err <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">KEY_ERROR: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>key<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n        err<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">=</span> <span class=\"token number\">400</span>\n        <span class=\"token keyword\">throw</span> err\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">await</span> UserService<span class=\"token punctuation\">.</span><span class=\"token function\">signUp</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span> email<span class=\"token punctuation\">,</span> userAccount<span class=\"token punctuation\">,</span> phoneNumber<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">)</span>\n\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">201</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> message<span class=\"token operator\">:</span> <span class=\"token string\">'SIGNUP_SUCCESS'</span><span class=\"token punctuation\">,</span> email <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">||</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> message<span class=\"token operator\">:</span> err<span class=\"token punctuation\">.</span>message <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>회원가입을 할 때 반드시 넘겨받아야 하는 key들을 <code class=\"language-text\">requiredKeys</code>라는 배열에 담고, <code class=\"language-text\">for...of</code>를 돌린다. 만약에 req.body로 받은 값 중에 하나가 undefined라면 그에 해당하는 키에러를 뿌린다.</p>\n<p>필수값들을 다 받아오면 DB에 저장을 하고, 201을 response로 클라이언트에 보내준다!</p>\n<p><code class=\"language-text\">for...of</code>도 참 요상한 친구라서 따로 정리를 해야겠다.</p>\n<br/>\n<h3 id=\"-얼레벌레-필터링-구현\" style=\"position:relative;\"><a href=\"#-%EC%96%BC%EB%A0%88%EB%B2%8C%EB%A0%88-%ED%95%84%ED%84%B0%EB%A7%81-%EA%B5%AC%ED%98%84\" aria-label=\" 얼레벌레 필터링 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🥴 얼레벌레 필터링 구현</h3>\n<p><a href=\"https://undefinedp.github.io/%ED%9A%8C%EA%B3%A0/BASENOTE-REF/#%EC%9D%B4%EB%B2%88%EC%97%90-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%98%EB%A9%B4%EC%84%9C-%EA%B3%A0%EB%A0%A4%ED%95%9C-%EA%B2%83\">위에서</a> 쓴것과 마찬가지로 필터링 기능을 구현할 때 중복되는 코드를 줄이는 것이 목표 중 하나였다.</p>\n<p>이미 이전에 작성한 코드가 2.5ml와 40ml에 따라 다른 데이터를 클라이언트한테 보내야했기 때문에 <code class=\"language-text\">Path Variable</code>을 사용해서 용량의 아이디를 변수로 사용해서 경로를 지정해놓았다. 그 상태에서 짜놓은 SQL문에 필터링 기능을 추가하기 위해서 이런 저런 방법을 해 보았지만 이게 원래 안되는건지..역량 부족인지…(역량 부족인듯) 결국 코드를 중복시키고 말았다 젠장야로~~</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">const findProducts <span class=\"token operator\">=</span> async <span class=\"token punctuation\">(</span>volume<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> {\n  <span class=\"token keyword\">return</span> prisma<span class=\"token punctuation\">.</span>$queryRaw<span class=\"token punctuation\">(</span><span class=\"token punctuation\">`</span>\n    <span class=\"token keyword\">SELECT</span>\n      products<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n      products<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>\n      series<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> series<span class=\"token punctuation\">,</span>\n      products<span class=\"token punctuation\">.</span>series_number <span class=\"token keyword\">as</span> seriesNumber<span class=\"token punctuation\">,</span>\n      images<span class=\"token punctuation\">.</span>image_url <span class=\"token keyword\">as</span> imageURL<span class=\"token punctuation\">,</span>\n      volumes<span class=\"token punctuation\">.</span>price\n    <span class=\"token keyword\">FROM</span> products\n      <span class=\"token keyword\">JOIN</span> products_volume\n        <span class=\"token keyword\">ON</span> products<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> products_volume<span class=\"token punctuation\">.</span>product_id\n      <span class=\"token keyword\">JOIN</span> volumes\n        <span class=\"token keyword\">ON</span> volumes<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> products_volume<span class=\"token punctuation\">.</span>volume_id\n      <span class=\"token keyword\">JOIN</span> series\n        <span class=\"token keyword\">ON</span> series<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> products<span class=\"token punctuation\">.</span>series_id\n      <span class=\"token keyword\">JOIN</span> images\n        <span class=\"token keyword\">ON</span> images<span class=\"token punctuation\">.</span>product_id <span class=\"token operator\">=</span> products<span class=\"token punctuation\">.</span>id\n    <span class=\"token keyword\">WHERE</span> volumes<span class=\"token punctuation\">.</span>volume_ml <span class=\"token operator\">=</span> <span class=\"token string\">'${volume}'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">`</span><span class=\"token punctuation\">)</span>\n}</code></pre></div>\n<p>처음에는 위에서 설명한대로 volume을 변수에 담아주었다. 그리고 단순하게 뒤에 그냥 상품의 향을 변수로 담아서 query parameter로 넘기면 되겠구나! 라고 생각을 했는데 어림도 없지!</p>\n<p>간과한게 하나 있었는데, query parameter로 상품의 향이 아무것도 넘어오지 않는다면 그냥 전체 상품에 대한 데이터를 뿌려줬어야했던 것…! 아무리 저 sql문에서 휘뚜루마뚜루 추가를 해보고 고쳐봐도 빈 배열을 뿌려주는 야속한 상황이 일어났고…ㅜ 결국에는 query parameter을 사용하는 로직을 따로 분리를 해주었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">const findProducts <span class=\"token operator\">=</span> async <span class=\"token punctuation\">(</span>volumeId<span class=\"token punctuation\">,</span> scentName<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> {\n  <span class=\"token keyword\">return</span> prisma<span class=\"token punctuation\">.</span>$queryRaw<span class=\"token punctuation\">(</span><span class=\"token punctuation\">`</span>\n  <span class=\"token keyword\">SELECT</span>\n        products<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n        products<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>\n        series<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> series<span class=\"token punctuation\">,</span>\n        products<span class=\"token punctuation\">.</span>series_number <span class=\"token keyword\">as</span> seriesNumber<span class=\"token punctuation\">,</span>\n        images<span class=\"token punctuation\">.</span>image_url <span class=\"token keyword\">as</span> imageURL<span class=\"token punctuation\">,</span>\n        volumes<span class=\"token punctuation\">.</span>price<span class=\"token punctuation\">,</span>\n        scents<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> scentName\n    <span class=\"token keyword\">FROM</span> products\n        <span class=\"token keyword\">JOIN</span> products_volume\n          <span class=\"token keyword\">ON</span> products<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> products_volume<span class=\"token punctuation\">.</span>product_id\n        <span class=\"token keyword\">JOIN</span> volumes\n          <span class=\"token keyword\">ON</span> volumes<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> products_volume<span class=\"token punctuation\">.</span>volume_id\n        <span class=\"token keyword\">JOIN</span> series\n          <span class=\"token keyword\">ON</span> series<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> products<span class=\"token punctuation\">.</span>series_id\n        <span class=\"token keyword\">JOIN</span> images\n          <span class=\"token keyword\">ON</span> images<span class=\"token punctuation\">.</span>product_id <span class=\"token operator\">=</span> products<span class=\"token punctuation\">.</span>id\n        <span class=\"token keyword\">JOIN</span> scent_products\n          <span class=\"token keyword\">ON</span> products<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> scent_products<span class=\"token punctuation\">.</span>product_id\n        <span class=\"token keyword\">JOIN</span> scents\n          <span class=\"token keyword\">ON</span> scents<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> scent_products<span class=\"token punctuation\">.</span>scent_id\n    <span class=\"token keyword\">WHERE</span> volumes<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> ${volumeId} <span class=\"token operator\">AND</span> scents<span class=\"token punctuation\">.</span>name\n        <span class=\"token operator\">LIKE</span> concat <span class=\"token punctuation\">(</span><span class=\"token string\">'%'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'${scentName}'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'%'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> products<span class=\"token punctuation\">.</span>name\n    <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> id\n  <span class=\"token punctuation\">`</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n}<span class=\"token punctuation\">;</span></code></pre></div>\n<p>이렇게!</p>\n<p>일단 향의 이름을 출력해줘야하기 때문에 위의 로직과는 다르게 <code class=\"language-text\">scents.name</code>을 추가해주었다. 그리고 <code class=\"language-text\">WHERE</code>문에 volumeId(용량)과 향의 이름을 변수로 지정을 해서, 두 가지를 다 클라이언트측에서 받아와야지만 데이터를 출력할 수 있는 형태로 sql을 수정해주었다.</p>\n<p>Query parameter로 라우팅 처리를 하기로 했고, 문자열로 주고받을 수 있도록 하는게 직관적일 것 같다고 판단을 해서 문자열이 일치하는지를 검색할 수 있는 <code class=\"language-text\">LIKE</code>메서드를 사용하기로 했다. 일부 문자가 아니라 모든 문자를 사용할 것이기 때문에 앞뒤로 <code class=\"language-text\">%</code>를 사용해주었다.</p>\n<p>concat은… 지금 보니 필요없다고 판단이 된다. 두 개의 문자열을 연결할 필요가 없기 때문에..! 봐도봐도 고칠 게 나오다니 정말 대단해</p>\n<p><img src=\"https://i.imgur.com/J9wjeLs.gif\" alt=\"coderefactoring\"></p>\n<p>또 필터링을 할 때 순서가 랜덤으로 뽑히는 사태가 일어났다. <code class=\"language-text\">ORDER BY</code>를 추가해서 id순으로 정렬이 되서 나올 수 있게 수정해주면 깔-끔!</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1063px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAABl0lEQVQ4y51U2XLDMAj0/39n+1AncRrd6DDdlexM2qZpU2Z2kDADLCBPp2VR65wu0PM86+F4UGutOti+au/9r5jMclQfvOactQCSRUutWkpREdG6nakp67rexS5TilFTSvpJ1s9XBtt9fgrGpL1CVsPqfspM0Jk+jypkUjKaWmu6AjTUVq/U9kIfJbqH6XR4U4dSCR/YeIdMSQUUa8lPB50MJwhETNGFiIlHNS4gQdAGqjvNv8rU2FBUI8ZozGh+aSpAqVuQJ4L1gLmgb2x8QFXYw3cTtbX14QAeUhbuGIZSQNcfZj1bp+8uA6IXP/TZii42dZx5B04mdex2nmmfYubSIiBGzvVIZb1W+B9BwKyNlDFl8/Kq88mq8Xwx6CcQZSBIgS7Xu0+lg/awnWnvAfvzSqJiDRwSHKq6OJw8tLsDG3KHiwPjXDbK7CEmnbAqPtXvb+8pynJL+UXfjpfe3JF5VGIIP/R+v3jp6HYOD2d+65TLRjmnqMI3yV3M1PXayx1fe5tu7tSjh3zL+OuEi+lrwqn/Vz4AW4o4bb2Bas0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"path_variable\"\n        title=\"path_variable\"\n        src=\"/static/a582c1a5a50b3d1bab12a09702215adb/47aef/path_variable.png\"\n        srcset=\"/static/a582c1a5a50b3d1bab12a09702215adb/5a46d/path_variable.png 300w,\n/static/a582c1a5a50b3d1bab12a09702215adb/0a47e/path_variable.png 600w,\n/static/a582c1a5a50b3d1bab12a09702215adb/47aef/path_variable.png 1063w\"\n        sizes=\"(max-width: 1063px) 100vw, 1063px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n전체 product를 볼 때</p>\n<br/>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 844px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 108.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAACBklEQVQ4y51Vi5LbIAz0//9lM73WSUxs3i87upWw40ybtHdmZgcMZNGuBOmUupG1DrB0vV6p73s6n890uVykZ0zTRN57cs49wPtfoZtuilywFEKQjdwbayjEQBHjjSilRDlnijHKeFmWl+iSM6RHRTM+7vf7SyxPa7VWAbdXe7tBKdLayOnvNm3gxhFy1O8Jh0G0s4x/kW2EfDDvfUtIT+1/hF9BF2yTm1OmkALlWiQZ8zwfOqTrf31IubBsLg9jDI3jKN9aa2QYdnhHrPhLhB6R5VKorJBsLzMWF8kmR8p4VyZ/lU0s/COQQF5B9iLg84LaLHSkdT4XiYQJMyTa0wm340ZXHeFppVRminmHx5yPVdZ4zHM8drHIPCRDap0bIfwzpx80wMPzFGlymbQvZAD9QH70E2DW8egauoAIWTL7VOHhItnd6+7bkpmwzi3CwneZsx2apGMeJvZwl2wh+XpWNJgkvoS8+8UwSJYFXKwCn1rP0nm+cyib3UNL7uMnKdQje8jebARmxfN4I3n2tGV5rTX2cJaX5E4HLWx1+PAQ/nlEd7P5eFJaHa6SQehQh+qi6LJKtptM32SKNCmn1vM8e21jWxMPmXBBRBl/Bb7/TSOSoxDlVsDPSfF/JCOsxR1zm2uE610teOdK5uf9LjjmYeabUuVRyLjHAVFOLpEGtofhO/gEBcO+MLmr9hoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"query_parameter\"\n        title=\"query_parameter\"\n        src=\"/static/7a7e60950d9ad8ceb9ea05047fa07f80/33e10/query_parameter.png\"\n        srcset=\"/static/7a7e60950d9ad8ceb9ea05047fa07f80/5a46d/query_parameter.png 300w,\n/static/7a7e60950d9ad8ceb9ea05047fa07f80/0a47e/query_parameter.png 600w,\n/static/7a7e60950d9ad8ceb9ea05047fa07f80/33e10/query_parameter.png 844w\"\n        sizes=\"(max-width: 844px) 100vw, 844px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n향 이름으로 필터링을 걸었을 때</p>\n<br/>\n<p>이렇게! 필터링이 원활하게 작동되는 것을 확인할 수 있다!</p>\n<br/>\n<h3 id=\"-필터링-다-했니-이제-에러-핸들링-가보자고\" style=\"position:relative;\"><a href=\"#-%ED%95%84%ED%84%B0%EB%A7%81-%EB%8B%A4-%ED%96%88%EB%8B%88-%EC%9D%B4%EC%A0%9C-%EC%97%90%EB%9F%AC-%ED%95%B8%EB%93%A4%EB%A7%81-%EA%B0%80%EB%B3%B4%EC%9E%90%EA%B3%A0\" aria-label=\" 필터링 다 했니 이제 에러 핸들링 가보자고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>😎 필터링 다 했니? 이제 에러 핸들링 가보자고</h3>\n<p>클라이언트가 용량의 아이디를 넣어야 하는 곳에 이상한 숫자를 넣거나, 없는 향을 요청을 보내면 안되기 때문에 이에 대한 에러 처리를 해주어야 했다.\n<br/></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> filter <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ProductService<span class=\"token punctuation\">.</span><span class=\"token function\">findProducts</span><span class=\"token punctuation\">(</span>volumeId<span class=\"token punctuation\">,</span> scentName<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>volumeId <span class=\"token operator\">&lt;</span> <span class=\"token number\">3</span> <span class=\"token operator\">&amp;&amp;</span> volumeId <span class=\"token operator\">>=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  err <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'INVALID_ACCESS'</span><span class=\"token punctuation\">)</span>\n  err<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">=</span> <span class=\"token number\">400</span>\n  <span class=\"token keyword\">throw</span> err\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>scentName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> products <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ProductService<span class=\"token punctuation\">.</span><span class=\"token function\">findAllProducts</span><span class=\"token punctuation\">(</span>volumeId<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> res\n    <span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> messate<span class=\"token operator\">:</span> <span class=\"token string\">'FIND_PRODUCTS_SUCCESSFULLY'</span><span class=\"token punctuation\">,</span> products <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>filter<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  err <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'INVALID_SCENT_NAME'</span><span class=\"token punctuation\">)</span>\n  err<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">=</span> <span class=\"token number\">400</span>\n  <span class=\"token keyword\">throw</span> err\n<span class=\"token punctuation\">}</span>\n\nres<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> message<span class=\"token operator\">:</span> <span class=\"token string\">'FILTER_PRODUCTS_SUCCESSFULLY'</span><span class=\"token punctuation\">,</span> filter <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-text\">if...else</code>를 남발하고 싶지 않아서 고민을 좀 했다 우짜지…어떻게 해야 가독성이 좋아지지…그러다가 <a href=\"https://eblo.tistory.com/7\">이런 방법</a>을 발견했다. <strong>Gateway style</strong>을 도입을 해도 괜찮을 것 같아서 한번?도입을?해?보았다.</p>\n<p>난 Gateway style을 속된말로 <em>입구컷 시킨다</em>라고 받아들였다. 예를 들어서 고급 레스토랑에 저녁 먹으러 갔는데 슬리퍼에 청바지 입었다고 입장하실 수 없습니다…라고 하는 덩치 큰 가드 아저씨가 나오고… 뭐 그런 미드에나 나올법한 장면이라고 해야하나.</p>\n<p>서비스적인 입장에서 생각을 해 보았을때 보통 사람들은</p>\n<ol>\n<li>용량에 따라 먼저 선택을 한다</li>\n<li>좋아하는 향을 필터링하기 위해서 클릭을 한다</li>\n<li>그 다음에는 그 필터를 제거하기 위해서 또 클릭을 할 수도 있고, 안 할 수도 있다</li>\n</ol>\n<p>이런 흐름으로 진행이 될 것이라고 생각했다. 그래서 조건문도 순서대로 걸어주었 *(입구컷을 시켰)*다.</p>\n<ol>\n<li>지정해놓은 용량의 id에서 벗어날 시에 에러를 던진다</li>\n<li>향의 이름이 undefined일 때, 전체 상품의 데이터를 뿌려준다</li>\n<li>DB에 없는 향의 이름으로 접근을 하려고 할 시에 에러를 던진다.</li>\n<li>올바르게 접근을 할 시, 해당하는 향을 가지고 있는 상품만 출력을 한다.</li>\n</ol>\n<p>의외로 막혔던게 <code class=\"language-text\">statusCode</code>를 설정하는 부분이었다. 400을 할까.. 404를 할까 고민을 많이 했는데 애초에 클라이언트가 리퀘스트를 잘못 보내서 발생하는 에러이기 때문에 400으로 설정을 했다.</p>\n<br/>\n<h3 id=\"-과정을-다시-돌아보면서\" style=\"position:relative;\"><a href=\"#-%EA%B3%BC%EC%A0%95%EC%9D%84-%EB%8B%A4%EC%8B%9C-%EB%8F%8C%EC%95%84%EB%B3%B4%EB%A9%B4%EC%84%9C\" aria-label=\" 과정을 다시 돌아보면서 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🔎 과정을 다시 돌아보면서</h3>\n<p>정말 믿을 수가 없다…엥 구라치지 마세요;\n엄청난 시행착오를 겪어서 나온게 저런 코드라니? 심지어 중복이 엄청나게 되는!!! 코드라니?!! 그런데 SQL문으로 작성을 해서 저렇게 중복이 나오게 되는건지, 아니면 ORM으로 작성을 했을 때도 저렇게 중복해서 나오게 되는건지는 더 테스트를 해보아야 할 것 같다.</p>\n<p>분명히 더 나은 방법이 있을거다. 근데 그걸 내가 모르는 것 뿐…딱 대 나오기만 해봐 내가 어떻게든 나오게 한다…점점 오기가 생기는 이 기분 짜릿하네..어 나 이런거 좋아했네…?</p>\n<p>저번에도 한달 지나면 리팩토링할게 산처럼 많아질 것 같다는 뉘앙스로 적었던적이 있는데 역시나 아니나 다를까 그 말이 맞았다. 또 다음달에 보면 아니 뭔 코드를 이렇게 짰냐;;하면서 뜯어고치는건 아닌가 몰라?</p>\n<p>다음달의 내가 엥,,코드 왜 이래,,라고 말하기 전에 ‘아~ 이래서 이렇게 썼구나~‘라고 알 수 있게 적어봤다.\n이 코드가…! 다음달의 내가 봐도 납득할 수 있는 코드였으면 좋겠다 ..! 물론 아니어도 상관은 없음 그만큰 내가 더 많이 알았다는거니까😉</p>","frontmatter":{"title":"✏️BASENOTE 프로젝트 회고 ver.2","date":"September 27, 2021"}}},"pageContext":{"slug":"/회고/BASENOTE-REF/","previous":{"fields":{"slug":"/회고/BASENOTE/"},"frontmatter":{"title":"✏️BASENOTE 프로젝트 회고 ver.1"}},"next":{"fields":{"slug":"/DevOps/GA/"},"frontmatter":{"title":"🪄GitHub Actions를 이용해서 CI/CD를 구축해보자!"}}}},
    "staticQueryHashes": ["2486386679","3128451518"]}